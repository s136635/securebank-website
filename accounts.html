<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounts - SecureBank</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="images/logo.png" alt="Bank Logo" width="40" height="40" class="d-inline-block align-text-top me-2">
                SecureBank
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About Us</a></li>
                    <li class="nav-item"><a class="nav-link active" href="accounts.html">Accounts</a></li>
                    <li class="nav-item"><a class="nav-link" href="transfers.html">Transfers</a></li>
                    <li class="nav-item"><a class="nav-link" href="loans.html">Loans</a></li>
                    <li class="nav-item"><a class="nav-link" href="support.html">Support</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                    <li class="nav-item"><a class="nav-link" href="questionnaire.html">Feedback</a></li>
                    <li class="nav-item"><a class="nav-link" href="calculator.html">Calculator</a></li>
                    <li class="nav-item"><a class="nav-link" href="funpage.html">Fun & Games</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-5">
        <div class="row">
            <div class="col-12">
                <h1 class="text-primary mb-4"><i class="bi bi-wallet2 me-2"></i>Bank Accounts</h1>
                
                <!-- Add Account Form -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h3 class="h5 mb-0">Add New Account</h3>
                    </div>
                    <div class="card-body">
                        <form id="addAccountForm">
                            <div class="row g-3">
                                <div class="col-md-3">
                                    <label for="accountType" class="form-label">Account Type *</label>
                                    <select class="form-select" id="accountType" required>
                                        <option value="">Select Type</option>
                                        <option value="Savings">Savings</option>
                                        <option value="Checking">Checking</option>
                                        <option value="Business">Business</option>
                                        <option value="Student">Student</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="accountNumber" class="form-label">Account Number *</label>
                                    <input type="text" class="form-control" id="accountNumber" required 
                                           placeholder="e.g., ACC001">
                                </div>
                                <div class="col-md-3">
                                    <label for="balance" class="form-label">Balance *</label>
                                    <input type="number" class="form-control" id="balance" required 
                                           placeholder="0.00" step="0.01" min="0">
                                </div>
                                <div class="col-md-3">
                                    <label for="currency" class="form-label">Currency *</label>
                                    <select class="form-select" id="currency" required>
                                        <option value="OMR">OMR</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-3">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-plus-circle me-1"></i>Add Account
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Search Form -->
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white">
                        <h3 class="h5 mb-0">Search Accounts</h3>
                    </div>
                    <div class="card-body">
                        <form id="searchAccountForm">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="searchType" class="form-label">Search by Type</label>
                                    <select class="form-select" id="searchType">
                                        <option value="">All Types</option>
                                        <option value="Savings">Savings</option>
                                        <option value="Checking">Checking</option>
                                        <option value="Business">Business</option>
                                        <option value="Student">Student</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="searchCurrency" class="form-label">Search by Currency</label>
                                    <select class="form-select" id="searchCurrency">
                                        <option value="">All Currencies</option>
                                        <option value="OMR">OMR</option>
                                        <option value="USD">USD</option>
                                        <option value="EUR">EUR</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mt-3">
                                <button type="submit" class="btn btn-success me-2">
                                    <i class="bi bi-search me-1"></i>Search
                                </button>
                                <button type="button" id="resetSearch" class="btn btn-outline-secondary">
                                    <i class="bi bi-arrow-clockwise me-1"></i>Reset
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Accounts Table -->
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="h5 mb-0">Account Information</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-hover" id="accountsTable">
                                <thead class="table-primary">
                                    <tr>
                                        <th>Account Type</th>
                                        <th>Account Number</th>
                                        <th>Balance</th>
                                        <th>Currency</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="accountsTableBody">
                                    <!-- Table rows will be dynamically populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy; 2025 SecureBank. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="text-white text-decoration-none me-3">Privacy Policy</a>
                    <a href="#" class="text-white text-decoration-none">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        /**
         * ACCOUNT MANAGEMENT SYSTEM
         * This script implements dynamic content management for bank accounts
         * using JavaScript objects, arrays, and functions
         */

        // =============================================
        // OBJECT CONSTRUCTORS
        // =============================================

        /**
         * Account constructor function
         * Creates Account objects with specified properties
         * @param {string} type - Type of account (Savings, Checking, etc.)
         * @param {string} number - Account number
         * @param {number} balance - Current account balance
         * @param {string} currency - Currency type (OMR, USD, EUR)
         */
        function Account(type, number, balance, currency) {
            this.type = type;
            this.number = number;
            this.balance = parseFloat(balance);
            this.currency = currency;
            this.status = balance >= 0 ? 'Active' : 'Overdrawn';
            this.createdDate = new Date().toLocaleDateString();
        }

        /**
         * Loan constructor function
         * Creates Loan objects with specified properties
         * @param {string} type - Type of loan (Personal, Mortgage, etc.)
         * @param {string} number - Loan account number
         * @param {number} amount - Original loan amount
         * @param {number} balance - Remaining loan balance
         * @param {number} interest - Interest rate percentage
         */
        function Loan(type, number, amount, balance, interest) {
            this.type = type;
            this.number = number;
            this.amount = parseFloat(amount);
            this.balance = parseFloat(balance);
            this.interest = parseFloat(interest);
            this.status = balance > 0 ? 'Active' : 'Paid Off';
        }

        // =============================================
        // DATA ARRAYS INITIALIZATION
        // =============================================

        /**
         * Array to store Account objects
         * Pre-populated with sample account data
         */
        const accountsArray = [
            new Account('Savings', 'SAV001', 1500.00, 'OMR'),
            new Account('Checking', 'CHK001', 2500.75, 'OMR'),
            new Account('Business', 'BUS001', 15000.00, 'USD'),
            new Account('Student', 'STU001', 500.50, 'OMR'),
            new Account('Savings', 'SAV002', 3200.25, 'EUR')
        ];

        /**
         * Array to store Loan objects
         * Pre-populated with sample loan data
         */
        const loansArray = [
            new Loan('Personal', 'LN001', 10000, 7500, 5.5),
            new Loan('Mortgage', 'LN002', 150000, 125000, 3.2),
            new Loan('Auto', 'LN003', 25000, 18000, 4.8),
            new Loan('Business', 'LN004', 50000, 35000, 6.0)
        ];

        // =============================================
        // DISPLAY FUNCTIONS
        // =============================================

        /**
         * Dynamically displays accounts in the accounts table
         * Clears existing rows and populates with current account data
         * @param {Array} accounts - Array of Account objects to display
         */
        function displayAccounts(accounts = accountsArray) {
            const tableBody = document.getElementById('accountsTableBody');
            
            // Clear existing table rows
            tableBody.innerHTML = '';
            
            // Check if there are accounts to display
            if (accounts.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" class="text-center text-muted py-4">
                            <i class="bi bi-info-circle me-2"></i>No accounts found matching your criteria.
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Create and append table rows for each account
            accounts.forEach(account => {
                const row = document.createElement('tr');
                
                // Determine status badge color
                const statusClass = account.status === 'Active' ? 'bg-success' : 'bg-warning';
                
                // Format balance with currency
                const formattedBalance = account.balance.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                // Populate row with account data
                row.innerHTML = `
                    <td>
                        <span class="badge bg-primary">${account.type}</span>
                    </td>
                    <td>
                        <strong>${account.number}</strong>
                    </td>
                    <td>
                        <span class="fw-bold">${formattedBalance}</span>
                    </td>
                    <td>
                        <span class="badge bg-secondary">${account.currency}</span>
                    </td>
                    <td>
                        <span class="badge ${statusClass}">${account.status}</span>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        /**
         * Dynamically displays loans in the loans table
         * Clears existing rows and populates with current loan data
         * @param {Array} loans - Array of Loan objects to display
         */
        function displayLoans(loans = loansArray) {
            const tableBody = document.getElementById('loansTableBody');
            
            if (!tableBody) return; // Only run on loans page
            
            // Clear existing table rows
            tableBody.innerHTML = '';
            
            // Check if there are loans to display
            if (loans.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center text-muted py-4">
                            <i class="bi bi-info-circle me-2"></i>No loans found matching your criteria.
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Create and append table rows for each loan
            loans.forEach(loan => {
                const row = document.createElement('tr');
                
                // Determine status badge color
                const statusClass = loan.status === 'Active' ? 'bg-warning' : 'bg-success';
                
                // Format amounts
                const formattedAmount = loan.amount.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                const formattedBalance = loan.balance.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                // Calculate progress percentage
                const progress = ((loan.amount - loan.balance) / loan.amount * 100).toFixed(1);
                
                // Populate row with loan data
                row.innerHTML = `
                    <td>
                        <span class="badge bg-info">${loan.type}</span>
                    </td>
                    <td>
                        <strong>${loan.number}</strong>
                    </td>
                    <td>
                        <span class="fw-bold">${formattedAmount} OMR</span>
                    </td>
                    <td>
                        <span class="fw-bold">${formattedBalance} OMR</span>
                    </td>
                    <td>
                        <span class="badge bg-light text-dark">${loan.interest}%</span>
                    </td>
                    <td>
                        <span class="badge ${statusClass}">${loan.status}</span>
                        <div class="progress mt-1" style="height: 5px;">
                            <div class="progress-bar" role="progressbar" 
                                 style="width: ${progress}%" 
                                 aria-valuenow="${progress}" 
                                 aria-valuemin="0" 
                                 aria-valuemax="100">
                            </div>
                        </div>
                        <small class="text-muted">${progress}% paid</small>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        // =============================================
        // FORM HANDLING FUNCTIONS
        // =============================================

        /**
         * Handles adding a new account to the accounts array
         * Validates input and updates the display
         */
        function handleAddAccount() {
            const accountForm = document.getElementById('addAccountForm');
            
            if (accountForm) {
                accountForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // Get form values
                    const type = document.getElementById('accountType').value;
                    const number = document.getElementById('accountNumber').value;
                    const balance = document.getElementById('balance').value;
                    const currency = document.getElementById('currency').value;
                    
                    // Validate form
                    if (!type || !number || !balance) {
                        alert('Please fill in all required fields.');
                        return;
                    }
                    
                    // Check if account number already exists
                    const existingAccount = accountsArray.find(acc => acc.number === number);
                    if (existingAccount) {
                        alert('Account number already exists. Please use a different number.');
                        return;
                    }
                    
                    // Create new account object
                    const newAccount = new Account(type, number, balance, currency);
                    
                    // Add to accounts array
                    accountsArray.push(newAccount);
                    
                    // Update display
                    displayAccounts();
                    
                    // Reset form
                    accountForm.reset();
                    
                    // Show success message
                    alert(`Account ${number} added successfully!`);
                });
            }
        }

        /**
         * Handles searching and filtering accounts
         */
        function handleSearchAccounts() {
            const searchForm = document.getElementById('searchAccountForm');
            const resetButton = document.getElementById('resetSearch');
            
            if (searchForm) {
                searchForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const typeFilter = document.getElementById('searchType').value;
                    const currencyFilter = document.getElementById('searchCurrency').value;
                    
                    // Filter accounts based on search criteria
                    const filteredAccounts = accountsArray.filter(account => {
                        const typeMatch = !typeFilter || account.type === typeFilter;
                        const currencyMatch = !currencyFilter || account.currency === currencyFilter;
                        return typeMatch && currencyMatch;
                    });
                    
                    // Display filtered results
                    displayAccounts(filteredAccounts);
                });
            }
            
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    document.getElementById('searchAccountForm').reset();
                    displayAccounts();
                });
            }
        }

        /**
         * Handles searching and filtering loans
         */
        function handleSearchLoans() {
            const searchForm = document.getElementById('searchLoanForm');
            const resetButton = document.getElementById('resetLoanSearch');
            
            if (searchForm) {
                searchForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const typeFilter = document.getElementById('searchLoanType').value;
                    const statusFilter = document.getElementById('searchLoanStatus').value;
                    
                    // Filter loans based on search criteria
                    const filteredLoans = loansArray.filter(loan => {
                        const typeMatch = !typeFilter || loan.type === typeFilter;
                        const statusMatch = !statusFilter || loan.status === statusFilter;
                        return typeMatch && statusMatch;
                    });
                    
                    // Display filtered results
                    displayLoans(filteredLoans);
                });
            }
            
            if (resetButton) {
                resetButton.addEventListener('click', function() {
                    document.getElementById('searchLoanForm').reset();
                    displayLoans();
                });
            }
        }

        // =============================================
        // INITIALIZATION
        // =============================================

        /**
         * Initialize the page when DOM is loaded
         */
        function initializePage() {
            // Display initial data
            displayAccounts();
            displayLoans();
            
            // Set up event handlers
            handleAddAccount();
            handleSearchAccounts();
            handleSearchLoans();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializePage);
    </script>
</body>
</html>